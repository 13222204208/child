/*! 
 Build based on gin-vue-admin 
 Time : 1680141068000 */
import{r as e,D as a,o as t,c as o,d as s,e as l,w as r,h as n,a3 as c,a2 as d,f as u,cO as i,cP as m,j as p,cQ as f,V as y,b as h,E as b}from"./index.9fcd1cf4.js";import{E as v}from"./dialog.751eac14.js";import"./overlay.a3adf688.js";import{E as j,a as k}from"./table-column.1a5fcc4c.js";import"./checkbox.fecdbd3c.js";import"./tag.591c2959.js";/* empty css                *//* empty css               */import"./scrollbar.aed9ef7e.js";import{E as w}from"./tree.769858e5.js";/* empty css               *//* empty css              */import{u as I}from"./authority.fc9b2d99.js";import{g,s as _}from"./authorityBtn.a32845a9.js";import{_ as C}from"./_plugin-vue_export-helper.cdc0426e.js";import"./refs.432de9a6.js";import"./index.bb4181cc.js";import"./_Uint8Array.660aa69b.js";import"./_initCloneObject.a1ac0bc9.js";import"./isEqual.06eb6a45.js";import"./index.f783073c.js";const x={class:"clearfix sticky-button"},R={class:"tree-content"},D={class:"custom-tree-node"},E={key:0},V={class:"dialog-footer"},N={name:"Menus"},O=C(Object.assign(N,{props:{row:{default:function(){return{}},type:Object}},emits:["changeRow"],setup(C,{expose:N,emit:O}){const A=C,B=e(""),U=e([]),S=e([]),T=e(!1),q=e({children:"children",label:function(e){return e.meta.title}});(async()=>{const e=await i();U.value=e.data.menus;const a=(await m({authorityId:A.row.authorityId})).data.menus,t=[];a.forEach((e=>{a.some((a=>a.parentId===e.menuId))||t.push(Number(e.menuId))})),S.value=t})();const M=()=>{T.value=!0},P=e(null),Q=async()=>{const e=P.value.getCheckedNodes(!1,!0);0===(await f({menus:e,authorityId:A.row.authorityId})).code&&p({type:"success",message:"菜单设置成功!"})};N({enterAndNext:()=>{Q()},needConfirm:T});const z=e(!1),F=e([]),G=e([]),H=e();let J="";const K=e=>{G.value=e},L=e=>{z.value=!0,F.value=e.menuBtn},W=()=>{z.value=!1},X=async()=>{const e=G.value.map((e=>e.ID));0===(await _({menuID:J,selected:e,authorityId:A.row.authorityId})).code&&(p({type:"success",message:"设置成功"}),z.value=!1)},Y=(e,a)=>!e||-1!==a.meta.title.indexOf(e);return a(B,(e=>{P.value.filter(e)})),(e,a)=>{const i=h,m=b,f=w,_=j,N=k,T=v;return t(),o("div",null,[s("div",x,[l(i,{modelValue:B.value,"onUpdate:modelValue":a[0]||(a[0]=e=>B.value=e),class:"fitler",placeholder:"筛选"},null,8,["modelValue"]),l(m,{class:"fl-right",type:"primary",onClick:Q},{default:r((()=>[n("确 定")])),_:1})]),s("div",R,[l(f,{ref_key:"menuTree",ref:P,data:U.value,"default-checked-keys":S.value,props:q.value,"default-expand-all":"","highlight-current":"","node-key":"ID","show-checkbox":"","filter-node-method":Y,onCheck:M},{default:r((({node:e,data:a})=>[s("span",D,[s("span",null,c(e.label),1),s("span",null,[l(m,{type:"primary",link:"",style:d({color:C.row.defaultRouter===a.name?"#E6A23C":"#85ce61"}),disabled:!e.checked,onClick:()=>(async e=>{const a=await I({authorityId:A.row.authorityId,AuthorityName:A.row.authorityName,parentId:A.row.parentId,defaultRouter:e.name});0===a.code&&(p({type:"success",message:"设置成功"}),O("changeRow","defaultRouter",a.data.authority.defaultRouter))})(a)},{default:r((()=>[n(c(C.row.defaultRouter===a.name?"首页":"设为首页"),1)])),_:2},1032,["style","disabled","onClick"])]),a.menuBtn.length?(t(),o("span",E,[l(m,{type:"primary",link:"",onClick:()=>(async e=>{J=e.ID;const a=await g({menuID:J,authorityId:A.row.authorityId});0===a.code&&(L(e),await y(),a.data.selected&&a.data.selected.forEach((e=>{F.value.some((a=>{a.ID===e&&H.value.toggleRowSelection(a,!0)}))})))})(a)},{default:r((()=>[n(" 分配按钮 ")])),_:2},1032,["onClick"])])):u("",!0)])])),_:1},8,["data","default-checked-keys","props"])]),l(T,{modelValue:z.value,"onUpdate:modelValue":a[1]||(a[1]=e=>z.value=e),title:"分配按钮","destroy-on-close":""},{footer:r((()=>[s("div",V,[l(m,{onClick:W},{default:r((()=>[n("取 消")])),_:1}),l(m,{type:"primary",onClick:X},{default:r((()=>[n("确 定")])),_:1})])])),default:r((()=>[l(N,{ref_key:"btnTableRef",ref:H,data:F.value,"row-key":"ID",onSelectionChange:K},{default:r((()=>[l(_,{type:"selection",width:"55"}),l(_,{label:"按钮名称",prop:"name"}),l(_,{label:"按钮备注",prop:"desc"})])),_:1},8,["data"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-d1e06e89"]]);export{O as default};
